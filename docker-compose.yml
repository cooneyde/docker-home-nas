version: "3"
services:
  adguard:
    container_name: adguard
    image: adguard/adguardhome
    dns:
      - 127.0.0.1
      - 1.1.1.1
    networks: 
      docker-net-0:
        ipv4_address: 192.168.114.4 #static address you want on the container
    cap_add: 
      - NET_ADMIN
    environment: 
      TZ: 'Europe/Dublin'
    volumes: 
      - /share/cachedev1/adguardhome/workdir:/opt/adguardhome/work
      - /share/cachedev1/adguardhome/confdir:/opt/adguardhome/conf
    restart: always
  # pihole:
  #   container_name: pihole
  #   image: pihole/pihole:latest
  #   volumes:
  #     - '/share/cachedev1/pihole/etc/:/etc/pihole/'
  #     - '/share/cachedev1/pihole/etc-dnsmasq.d/:/etc/dnsmasq.d/'
  #   environment:
  #     TZ: Europe/Dublin
  #     SERVERIP: 192.168.114.3 #IP of the NAS
  #   dns:
  #     - 127.0.0.1
  #     - 1.1.1.1
  #   networks: 
  #     docker-net-0:
  #       ipv4_address: 192.168.114.4 #static address you want on the container
  #   cap_add: 
  #     - NET_ADMIN
  #   restart: unless-stopped
  #   healthcheck:
  #     test: ["CMD", "curl", "-f", "http://localhost"]
  #     interval: 1m30s
  #     timeout: 10s
  #     retries: 3
  watchtower:
    image: v2tec/watchtower
    container_name: watchtower
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    depends_on:
      - deluge
      - jackett
      - ombi
      - plex
      - portainer
      - radarr
      - sonarr
    command: 
      - "watchtower --interval 21600"
  deluge:
    image: linuxserver/deluge
    container_name: deluge
    environment:
      - TZ=Europe/London
      - PUID=1000
      - PGID=1000
      - UMASK_SET=022 #optional
      - DELUGE_LOGLEVEL=error #optional
    volumes:
      - /share/cachedev1/deluge:/config
      - /share/Download:/downloads
    ports:
      - 8112:8112
    restart: always
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost"]
      interval: 1m30s
      timeout: 10s
      retries: 3
  jackett:
    image: ghcr.io/linuxserver/jackett
    container_name: jackett
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/London
    volumes:
      - /share/cachedev1/jackett:/config
      - /share/Download:/downloads
    ports:
      - 9117:9117
    restart: always
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:9117"]
      interval: 1m30s
      timeout: 10s
      retries: 3
  ombi:
    image: linuxserver/ombi
    container_name: ombi
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/London
      - BASE_URL=/ombi #optional
    volumes:
      - /share/cachedev1/ombi:/config
    ports:
      - 3579:3579
    restart: always
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost"]
      interval: 1m30s
      timeout: 10s
      retries: 3
  plex:
    image: linuxserver/plex
    container_name: plex
    hostname: cooneyde
    networks: 
      docker-net-1:
        ipv4_address: 192.168.114.6
    environment:
      - PUID=1000
      - PGID=1000
      - VERSION=docker
      - UMASK_SET=022 #optional
    volumes:
      - /share/cachedev1/plex:/config
      - /share/Multimedia/video/tv-shows:/tv
      - /share/Multimedia/video/Movies:/movies
    restart: always
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:32400/identity"]
      interval: 1m30s
      timeout: 10s
      retries: 3
  portainer:
    container_name: portainer
    image: portainer/portainer-ce
    restart: always
    dns:
      - 127.0.0.1
      - 1.1.1.1
    networks: 
      docker-net-0:
        ipv4_address: 192.168.114.5
    ports:
      - 80:9000
    entrypoint: /portainer -p :80
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - /share/cachedev1/portainer:/data  
  radarr:
    image: linuxserver/radarr
    container_name: radarr
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/London
      - UMASK_SET=022 #optional
    volumes:
      - /share/cachedev1/radarr:/config
      - /share/Multimedia/video/Movies:/movies
      - /share/Download:/downloads
    ports:
      - 7878:7878
    network_mode: host
    restart: always
    depends_on:
      - jackett
      - deluge
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:7878"]
      interval: 1m30s
      timeout: 10s
      retries: 3
  sonarr:
    image: linuxserver/sonarr:preview
    container_name: sonarr
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/London
      - UMASK_SET=022 #optional
    ports:
      - 8989:8989
    network_mode: host
    volumes:
      - /share/cachedev1/sonarr:/config
      - /share/Multimedia/video/tv-shows:/tv
      - /share/Download:/downloads
    restart: always
    depends_on:
      - jackett
      - deluge
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8989"]
      interval: 1m30s
      timeout: 10s
      retries: 3
  heimdall:
    image: ghcr.io/linuxserver/heimdall
    container_name: heimdall
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/London
    volumes:
      - /share/cachedev1/heimdall:/config
    ports:
      - 8000:80
    restart: always
networks: 
  docker-net-0:
    external: true
  docker-net-1:
    external: true